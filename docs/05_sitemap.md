# サイトマップ設計

## 制約
- 個人開発（一人）
- 低コスト重視
- 運用が簡単

## サイトマップ（ページ一覧）

### ページ（利用者向け）
- `/`: トップ画面（Day選択・進捗確認）
- `/day/1`: Day1のチェックリスト表示
- `/day/2`: Day2のチェックリスト表示
- `/day/3`: Day3のチェックリスト表示
- `/checklist/:id`: チェックリスト項目の詳細ページ（モーダルまたは別ページ）

### ページ（管理者向け）
- `/admin`: 管理者ダッシュボード（統計・未解決ランキング）
- `/admin/items`: チェックリスト項目管理（CRUD）
- `/admin/users`: ユーザー管理（一覧・ロール変更）

## 画面遷移図
```mermaid
graph TB
    subgraph "利用者向け"
        A[/ トップ画面<br/>Day選択・進捗確認]
        B[/day/1<br/>Day1チェックリスト]
        C[/day/2<br/>Day2チェックリスト]
        D[/day/3<br/>Day3チェックリスト]
        E[/checklist/:id<br/>詳細ページ]
    end

    subgraph "管理者向け"
        F[/admin<br/>管理ダッシュボード]
        G[/admin/items<br/>項目管理]
        H[/admin/users<br/>ユーザー管理]
    end

    A -->|Day1クリック| B
    A -->|Day2クリック| C
    A -->|Day3クリック| D
    B -->|項目クリック| E
    C -->|項目クリック| E
    D -->|項目クリック| E
    E -->|戻る| B
    E -->|戻る| C
    E -->|戻る| D

    F -->|項目管理| G
    F -->|ユーザー管理| H
    G -->|戻る| F
    H -->|戻る| F

    style A fill:#e1f5ff
    style B fill:#fff4e1
    style C fill:#fff4e1
    style D fill:#fff4e1
    style E fill:#ffe1f5
    style F fill:#e1ffe1
    style G fill:#f5e1ff
    style H fill:#f5e1ff
```

## 主要画面の目的と要素

### / （トップ画面）
- **目的**: ユーザーが一目で現在の進捗状況を把握し、次のアクションを選択できる
- **要素**:
  - ヘッダー: ユーザー名、ログアウトボタン
  - 進捗サマリー: 全体の完了率（例: 8/15項目完了）
  - Day別カード:
    - Day1カード（完了数/全体数、進捗バー）
    - Day2カード（完了数/全体数、進捗バー）
    - Day3カード（完了数/全体数、進捗バー）
  - 未完了のみ表示トグルスイッチ
  - フッター: 問い合わせリンク

### /day/1 （Day1チェックリスト）
- **目的**: Day1に必要な設定項目を確認し、完了状態を記録する
- **要素**:
  - パンくずリスト: ホーム > Day1
  - タイトル: 「Day1 初期設定」
  - 進捗バー: Day1全体の進捗（例: 3/5完了）
  - チェックリスト一覧:
    - 各項目カード:
      - タイトル（例: Windowsログイン）
      - 概要（summary）
      - ステータスバッジ（未着手/完了/未解決）
      - 「詳細を見る」ボタン
      - 「解決した」「解決しなかった」ボタン
  - サイドバー:
    - 問い合わせボタン（Teamsチャットリンク）
  - 戻るボタン: トップ画面へ

### /day/2 （Day2チェックリスト）
- **目的**: Day2に必要な設定項目を確認し、完了状態を記録する
- **要素**: Day1と同じ構成（タイトルのみ「Day2」に変更）

### /day/3 （Day3チェックリスト）
- **目的**: Day3のトラブル対応項目を確認し、完了状態を記録する
- **要素**: Day1と同じ構成（タイトルのみ「Day3」に変更）

### /checklist/:id （詳細ページ）
- **目的**: チェックリスト項目の詳細な手順と注意点を表示する
- **要素**:
  - パンくずリスト: ホーム > Day1 > Windowsログイン
  - タイトル: 項目名
  - カテゴリーバッジ: （例: ログイン）
  - 概要セクション:
    - 結論（summary）
  - 手順セクション:
    - ステップバイステップの手順リスト
    - 各手順にチェックボックス（ローカル状態のみ）
  - 注意点セクション:
    - notes の内容
  - アクションボタン:
    - 「解決した」ボタン（緑）
    - 「解決しなかった」ボタン（赤）
    - 「この手順を送る」ボタン（リンクコピー）
    - 「教育担当に問い合わせる」ボタン（Teamsチャット）
  - 戻るボタン: Day画面へ

### /admin （管理ダッシュボード）
- **目的**: 全体の利用状況と問題箇所を把握する
- **要素**:
  - サマリーカード:
    - 総ユーザー数
    - アクティブユーザー数（過去7日間）
    - 全体完了率
  - 未解決ランキング:
    - 未解決数が多い項目トップ5
  - よく見られている項目:
    - 閲覧数が多い項目トップ5
  - 問い合わせクリック数:
    - 問い合わせボタンがクリックされた項目トップ5
  - ナビゲーション:
    - 項目管理へのリンク
    - ユーザー管理へのリンク

### /admin/items （項目管理）
- **目的**: チェックリスト項目のCRUD操作を行う
- **要素**:
  - パンくずリスト: 管理 > 項目管理
  - 「新規項目追加」ボタン
  - フィルター:
    - Day選択（1, 2, 3, 全て）
    - ステータス（有効/無効）
  - 項目一覧テーブル:
    - カラム: Day、カテゴリ、タイトル、表示順、有効/無効、編集ボタン、削除ボタン
  - ドラッグ&ドロップで順序変更（将来機能）
  - 戻るボタン: 管理ダッシュボードへ

### /admin/users （ユーザー管理）
- **目的**: ユーザーの一覧とロール変更を行う
- **要素**:
  - パンくずリスト: 管理 > ユーザー管理
  - 検索バー（名前、メールアドレス）
  - ユーザー一覧テーブル:
    - カラム: 名前、メールアドレス、入社日、ロール（ドロップダウンで変更可能）、進捗率
  - ページネーション（1ページ50人）
  - 戻るボタン: 管理ダッシュボードへ

## URL設計ルール
- **一覧**: `/day/:id` （Dayごとのチェックリスト一覧）
- **詳細**: `/checklist/:id` （個別項目の詳細）
- **管理画面**: `/admin` プレフィックス
- **RESTful**: URLはリソースを表現し、動詞を含まない
- **シンプル**: 階層は最大3階層まで（例: `/admin/items/new`）
- **ケバブケース**: 複数単語はケバブケース（例: `/checklist-items`）ではなく、単語を分けるかキャメルケースを使う場合は1単語に
- **日本語禁止**: URLに日本語を含めない（SEO・互換性）

## 指針
- **Home → 一覧 → 詳細 →（行動）の3画面で成立させる**: 最小のMVPとする
- **モバイルファースト**: スマホでも操作しやすいUI（iPhoneで見る想定）
- **シンプルなナビゲーション**: 迷わない導線設計
- **進捗の可視化**: どこまで完了したかが一目でわかる
- **クイックアクション**: よく使うボタン（解決/未解決）はすぐに押せる位置に
- **アクセシビリティ**: キーボード操作、スクリーンリーダー対応

## 運用観点
- **参照先（問い合わせURL、外部リンク、表示名）は config.ts など1箇所に集約**:
  - 例: Teamsチャットリンク、問い合わせフォームURL
  - 環境変数（`.env.local`）で管理し、`/lib/config.ts` で読み込む
  - 変更時は1箇所修正するだけで全画面に反映

- **エラーハンドリング**:
  - 404ページ: カスタムデザイン、トップへ戻るリンク
  - 500ページ: エラーメッセージ、再試行ボタン
  - APIエラー: トースト通知で表示

- **ローディング状態**:
  - Suspense境界でローディングスピナー表示
  - スケルトンスクリーンでUX向上

- **SEO考慮**:
  - 各ページにメタタグ設定（`metadata` export）
  - 動的OGP画像生成（Next.js Image Generation）

## レスポンシブデザイン方針
- **ブレークポイント**:
  - モバイル: 〜640px
  - タブレット: 641px〜1024px
  - デスクトップ: 1025px〜
- **優先順位**: モバイル > デスクトップ（新入社員はiPhoneで閲覧する想定）

## 認証・権限制御
- **全ページ**: NextAuth.jsで認証必須（未ログイン時は `/api/auth/signin` へリダイレクト）
- **管理者ページ**: ミドルウェアでロールチェック（`role === 'admin'` または `role === 'trainer'`）
- **権限不足時**: 403ページ表示

## パフォーマンス最適化
- **静的生成**: トップページ、Dayページはデータフェッチ後にISR（Incremental Static Regeneration）
- **動的レンダリング**: 進捗状態は動的にフェッチ（React Query）
- **画像最適化**: Next.js Imageコンポーネント使用
- **コード分割**: 管理者ページは遅延ロード（`dynamic import`）

## 画面モックアップ（簡易版）

### トップ画面（/）
```
┌─────────────────────────────────┐
│ 🏠 ITオンボーディング  [ログアウト]│
├─────────────────────────────────┤
│ こんにちは、山田太郎さん           │
│                                 │
│ 全体の進捗: ██████░░░ 60% (9/15)│
│                                 │
│ ┌─────────────────────────────┐ │
│ │ Day1 初期設定              │ │
│ │ ██████░░░ 75% (3/4)        │ │
│ │ [詳細を見る →]             │ │
│ └─────────────────────────────┘ │
│                                 │
│ ┌─────────────────────────────┐ │
│ │ Day2 ポータル・ツール設定    │ │
│ │ ████░░░░░ 50% (3/6)        │ │
│ │ [詳細を見る →]             │ │
│ └─────────────────────────────┘ │
│                                 │
│ ┌─────────────────────────────┐ │
│ │ Day3 トラブル対応           │ │
│ │ ████░░░░░ 60% (3/5)        │ │
│ │ [詳細を見る →]             │ │
│ └─────────────────────────────┘ │
│                                 │
│ [ ] 未完了のみ表示              │
└─────────────────────────────────┘
```

### Day1チェックリスト（/day/1）
```
┌─────────────────────────────────┐
│ ← ホーム > Day1                 │
├─────────────────────────────────┤
│ Day1 初期設定                   │
│ 進捗: ██████░░░ 75% (3/4)      │
│                                 │
│ ┌─────────────────────────────┐ │
│ │ ✅ Windowsログイン          │ │
│ │ Windows PCに初回ログイン...  │ │
│ │ [詳細] [✓解決] [✗未解決]    │ │
│ └─────────────────────────────┘ │
│                                 │
│ ┌─────────────────────────────┐ │
│ │ ⏸ Microsoft 365 初期設定    │ │
│ │ M365アカウントにログイン...  │ │
│ │ [詳細] [✓解決] [✗未解決]    │ │
│ └─────────────────────────────┘ │
│                                 │
│ 🔗 問い合わせ（Teamsチャット）   │
└─────────────────────────────────┘
```
